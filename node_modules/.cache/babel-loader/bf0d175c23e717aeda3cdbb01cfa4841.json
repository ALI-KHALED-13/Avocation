{"ast":null,"code":"var _jsxFileName = \"D:\\\\ali\\\\programming\\\\React\\\\avocation\\\\client\\\\src\\\\Components\\\\HomeComponents\\\\Avocata.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport mavatar from '../../media/avatar-m.png';\nimport favatar from '../../media/avatar-f.png';\nimport loading from '../../media/loading.gif';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Avocata = ({\n  data,\n  users,\n  user,\n  avocatas,\n  updataAvocatas\n}) => {\n  _s();\n\n  const author = users.find(user => user.userName === data.creator);\n  const mediaType = data.contentType;\n  const [deleting, setDeleting] = useState(false);\n  let fileURL; // delete the media url when the component unmounts (performance thing)\n\n  useEffect(() => () => URL.revokeObjectURL(fileURL), [fileURL]);\n\n  const insertMedia = () => {\n    const arrayBuffer = toArrayBuffer(data.fileBuffer.data);\n    const file = new File([arrayBuffer], data.fileName, {\n      type: mediaType\n    });\n    fileURL = URL.createObjectURL(file);\n\n    if (mediaType.startsWith('image/')) {\n      return /*#__PURE__*/_jsxDEV(\"img\", {\n        alt: \"data.fileName\",\n        src: fileURL,\n        className: \"media\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 20\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"audio\", {\n        controls: true,\n        className: \"media\",\n        children: /*#__PURE__*/_jsxDEV(\"source\", {\n          src: fileURL,\n          type: \"audio/mpeg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 26,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  const deleteAvoca = ev => {\n    setDeleting(true);\n    fetch('avocata', {\n      method: \"delete\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        id: data._id\n      })\n    }).then(resp => resp.json()).then(message => {\n      setDeleting(false);\n\n      if (message.deleted) {\n        updataAvocatas(avocatas.filter(avoca => avoca !== data));\n        URL.revokeObjectURL(fileURL); // (performance again)\n      } else {\n        alert(\"couldn't be deleted\");\n        console.log(message.error);\n      }\n    }).catch(console.log);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"article\", {\n    className: \"avocata\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: author.gender === 'male' ? mavatar : favatar,\n        alt: \"avatar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n        width: \"18\",\n        height: \"18\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"circle\", {\n          cx: \"10\",\n          cy: \"10\",\n          r: \"35%\",\n          fill: \"#26ff6b\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 47\n        }, this), \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [author.name, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 33\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"date-created\",\n          children: data.createdAt.slice(0, 10)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }, this), deleting && /*#__PURE__*/_jsxDEV(\"img\", {\n        alt: \"loading..\",\n        src: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 30\n      }, this), user.userName === author.userName && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: deleteAvoca,\n        children: \"Delete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 54\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content\",\n      children: [data.tags.indexOf('POE') >= 0 || data.tags.indexOf('شعر') >= 0 ? /*#__PURE__*/_jsxDEV(\"pre\", {\n        style: {\n          textAlign: data.text.match(/\\w/) ? 'left' : 'center'\n        },\n        children: data.text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          textAlign: data.text.match(/\\w/) ? 'left' : 'center'\n        },\n        children: data.text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 26\n      }, this), mediaType !== 'undefined' && insertMedia()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Avocata, \"b9HgKu0RI+fUhuW9vdtvYp9luJo=\");\n\n_c = Avocata;\nexport default _c2 = /*#__PURE__*/React.memo(Avocata);\n\nfunction toArrayBuffer(buffer) {\n  //useMemo IT ???\n  var ab = new ArrayBuffer(buffer.length);\n  var view = new Uint8Array(ab);\n\n  for (var i = 0; i < buffer.length; ++i) view[i] = buffer[i];\n\n  return ab;\n}\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Avocata\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["D:/ali/programming/React/avocation/client/src/Components/HomeComponents/Avocata.js"],"names":["React","useEffect","useState","mavatar","favatar","loading","Avocata","data","users","user","avocatas","updataAvocatas","author","find","userName","creator","mediaType","contentType","deleting","setDeleting","fileURL","URL","revokeObjectURL","insertMedia","arrayBuffer","toArrayBuffer","fileBuffer","file","File","fileName","type","createObjectURL","startsWith","deleteAvoca","ev","fetch","method","headers","body","JSON","stringify","id","_id","then","resp","json","message","deleted","filter","avoca","alert","console","log","error","catch","gender","name","createdAt","slice","tags","indexOf","textAlign","text","match","memo","buffer","ab","ArrayBuffer","length","view","Uint8Array","i"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport mavatar from '../../media/avatar-m.png';\r\nimport favatar from '../../media/avatar-f.png';\r\nimport loading from '../../media/loading.gif';\r\n\r\nconst Avocata =({data, users, user, avocatas, updataAvocatas})=>{\r\n\r\n    const author = users.find(user=> user.userName === data.creator);\r\n    const mediaType = data.contentType;\r\n    const [deleting, setDeleting] = useState(false);\r\n    let fileURL;\r\n\r\n    // delete the media url when the component unmounts (performance thing)\r\n    useEffect(()=> ()=> URL.revokeObjectURL(fileURL), [fileURL])\r\n\r\n    const insertMedia =()=>{\r\n        const arrayBuffer = toArrayBuffer(data.fileBuffer.data)\r\n        const file = new File([arrayBuffer], data.fileName, {type: mediaType});\r\n        fileURL = URL.createObjectURL(file);\r\n\r\n        if (mediaType.startsWith('image/')){\r\n            return <img alt=\"data.fileName\" src={fileURL} className=\"media\"/>\r\n        }else {\r\n            return (\r\n                <audio controls className=\"media\">\r\n                    <source src={fileURL} type=\"audio/mpeg\"></source>\r\n                </audio>\r\n                )\r\n        }\r\n    }\r\n    \r\n    \r\n    const deleteAvoca =(ev)=>{\r\n        setDeleting(true);\r\n\r\n        fetch('avocata', {\r\n            method:\"delete\",\r\n            headers: {\"Content-Type\": \"application/json\"},\r\n            body: JSON.stringify({id: data._id}),\r\n        })\r\n        .then(resp=> resp.json())\r\n        .then(message=> {\r\n            setDeleting(false);\r\n            if (message.deleted){\r\n                updataAvocatas(avocatas.filter(avoca=> avoca !== data));\r\n\r\n                URL.revokeObjectURL(fileURL); // (performance again)\r\n            }else{\r\n                alert(\"couldn't be deleted\")\r\n                console.log(message.error);\r\n            }\r\n        }).catch(console.log)\r\n    }\r\n\r\n    return (\r\n        <article className=\"avocata\">\r\n            <div className=\"header\">\r\n                \r\n                <img src={author.gender === 'male'? mavatar: favatar} alt=\"avatar\"/>\r\n                <svg width=\"18\" height=\"18\" > <circle cx=\"10\" cy=\"10\" r=\"35%\" fill=\"#26ff6b\"/> </svg>\r\n                \r\n\r\n                <p>{author.name}<br/>\r\n                <span className=\"date-created\">{data.createdAt.slice(0,10)}</span>\r\n                </p>\r\n                {deleting && <img alt=\"loading..\" src={loading} />}\r\n                {user.userName === author.userName &&<button onClick={deleteAvoca}>Delete</button>}\r\n            </div>\r\n            <div className=\"content\">\r\n                {\r\n                    data.tags.indexOf('POE') >= 0 || data.tags.indexOf('شعر') >= 0?\r\n                        <pre style={{textAlign: data.text.match(/\\w/)? 'left':'center'}}>{data.text}</pre>\r\n                        :<p style={{textAlign: data.text.match(/\\w/)? 'left':'center'}}>{data.text}</p>\r\n                }\r\n                {\r\n                  mediaType !== 'undefined' &&  insertMedia()\r\n                }\r\n            </div>\r\n        </article>\r\n    );\r\n}\r\nexport default React.memo(Avocata);\r\n\r\nfunction toArrayBuffer(buffer) { //useMemo IT ???\r\n    var ab = new ArrayBuffer(buffer.length);\r\n    var view = new Uint8Array(ab);\r\n    for (var i = 0; i < buffer.length; ++i) view[i] = buffer[i];\r\n    return ab;\r\n}"]},"metadata":{},"sourceType":"module"}