{"ast":null,"code":"var _jsxFileName = \"D:\\\\ali\\\\programming\\\\React\\\\avocation\\\\client\\\\src\\\\Components\\\\HomeComponents\\\\Avocata.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport mavatar from '../../media/avatar-m.png';\nimport favatar from '../../media/avatar-f.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Avocata = ({\n  data,\n  users,\n  user,\n  avocatas,\n  updataAvocatas\n}) => {\n  _s();\n\n  const author = users.find(user => user.userName === data.creator);\n  const mediaType = data.contentType;\n  let fileURL; // delete the url when the component unmounts (performance thing)\n\n  useEffect(() => () => URL.revokeObjectURL(fileURL), []);\n\n  const insertMedia = () => {\n    const arrayBuffer = toArrayBuffer(data.fileBuffer.data);\n    const file = new File([arrayBuffer], data.fileName, {\n      type: mediaType\n    });\n    fileURL = URL.createObjectURL(file);\n\n    if (mediaType.startsWith('image/')) {\n      return /*#__PURE__*/_jsxDEV(\"img\", {\n        alt: \"data.fileName\",\n        src: fileURL,\n        className: \"media\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 20\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"audio\", {\n        controls: true,\n        className: \"media\",\n        children: /*#__PURE__*/_jsxDEV(\"source\", {\n          src: fileURL,\n          type: \"audio/mpeg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 24,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  const deleteAvoca = ev => {\n    fetch('avocata', {\n      method: \"delete\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        id: data._id\n      })\n    }).then(resp => resp.json()).then(message => {\n      if (message.deleted) {\n        updataAvocatas(avocatas.filter(avoca => avoca !== data));\n        URL.revokeObjectURL(fileURL); // (performance again)\n\n        alert('avocata is deleted successfully');\n      } else {\n        alert(\"couldn't be deleted\");\n        console.log(message.error);\n      }\n    }).catch(console.log);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"article\", {\n    className: \"avocata\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: author.gender === 'male' ? mavatar : favatar,\n        alt: \"avatar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [author.name, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 33\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"date-created\",\n          children: data.createdAt.slice(0, 10)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 17\n      }, this), user.userName === author.userName && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: deleteAvoca,\n        children: \"Delete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 54\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content\",\n      children: [data.tags.indexOf('poe') >= 0 || data.tags.indexOf('شعر') >= 0 ? /*#__PURE__*/_jsxDEV(\"pre\", {\n        style: {\n          textAlign: data.text.match(/\\w/) ? 'left' : 'center'\n        },\n        children: data.text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          textAlign: data.text.match(/\\w/) ? 'left' : 'center'\n        },\n        children: data.text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 26\n      }, this), mediaType !== 'undefined' && insertMedia()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Avocata, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = Avocata;\nexport default _c2 = /*#__PURE__*/React.memo(Avocata);\n\nfunction toArrayBuffer(buffer) {\n  //useMemo IT ???\n  var ab = new ArrayBuffer(buffer.length);\n  var view = new Uint8Array(ab);\n\n  for (var i = 0; i < buffer.length; ++i) view[i] = buffer[i];\n\n  return ab;\n}\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Avocata\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["D:/ali/programming/React/avocation/client/src/Components/HomeComponents/Avocata.js"],"names":["React","useEffect","mavatar","favatar","Avocata","data","users","user","avocatas","updataAvocatas","author","find","userName","creator","mediaType","contentType","fileURL","URL","revokeObjectURL","insertMedia","arrayBuffer","toArrayBuffer","fileBuffer","file","File","fileName","type","createObjectURL","startsWith","deleteAvoca","ev","fetch","method","headers","body","JSON","stringify","id","_id","then","resp","json","message","deleted","filter","avoca","alert","console","log","error","catch","gender","name","createdAt","slice","tags","indexOf","textAlign","text","match","memo","buffer","ab","ArrayBuffer","length","view","Uint8Array","i"],"mappings":"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","sourcesContent":["import React, {useEffect} from 'react';\r\nimport mavatar from '../../media/avatar-m.png';\r\nimport favatar from '../../media/avatar-f.png';\r\n\r\nconst Avocata =({data, users, user, avocatas, updataAvocatas})=>{\r\n\r\n    const author = users.find(user=> user.userName === data.creator);\r\n    const mediaType = data.contentType;\r\n    let fileURL;\r\n\r\n    // delete the url when the component unmounts (performance thing)\r\n    useEffect(()=> ()=> URL.revokeObjectURL(fileURL), [])\r\n\r\n    const insertMedia =()=>{\r\n        const arrayBuffer = toArrayBuffer(data.fileBuffer.data)\r\n        const file = new File([arrayBuffer], data.fileName, {type: mediaType});\r\n        fileURL = URL.createObjectURL(file);\r\n\r\n        if (mediaType.startsWith('image/')){\r\n            return <img alt=\"data.fileName\" src={fileURL} className=\"media\"/>\r\n        }else {\r\n            return (\r\n                <audio controls className=\"media\">\r\n                    <source src={fileURL} type=\"audio/mpeg\"></source>\r\n                </audio>\r\n                )\r\n        }\r\n    }\r\n    \r\n    \r\n    const deleteAvoca =(ev)=>{\r\n        fetch('avocata', {\r\n            method:\"delete\",\r\n            headers: {\"Content-Type\": \"application/json\"},\r\n            body: JSON.stringify({id: data._id}),\r\n        })\r\n        .then(resp=> resp.json())\r\n        .then(message=> {\r\n            if (message.deleted){\r\n                updataAvocatas(avocatas.filter(avoca=> avoca !== data));\r\n\r\n                URL.revokeObjectURL(fileURL); // (performance again)\r\n                alert('avocata is deleted successfully');  \r\n            }else{\r\n                alert(\"couldn't be deleted\")\r\n                console.log(message.error);\r\n            }\r\n        }).catch(console.log)\r\n    }\r\n\r\n    return (\r\n        <article className=\"avocata\">\r\n            <div className=\"header\">\r\n                <img src={author.gender === 'male'? mavatar: favatar} alt=\"avatar\"/>\r\n\r\n                <p>{author.name}<br/>\r\n                <span className=\"date-created\">{data.createdAt.slice(0,10)}</span>\r\n                </p>\r\n\r\n                {user.userName === author.userName &&<button onClick={deleteAvoca}>Delete</button>}\r\n            </div>\r\n            <div className=\"content\">\r\n                {\r\n                    data.tags.indexOf('poe') >= 0 || data.tags.indexOf('شعر') >= 0?\r\n                        <pre style={{textAlign: data.text.match(/\\w/)? 'left':'center'}}>{data.text}</pre>\r\n                        :<p style={{textAlign: data.text.match(/\\w/)? 'left':'center'}}>{data.text}</p>\r\n                }\r\n                {\r\n                  mediaType !== 'undefined' &&  insertMedia()\r\n                }\r\n            </div>\r\n        </article>\r\n    );\r\n}\r\nexport default React.memo(Avocata);\r\n\r\nfunction toArrayBuffer(buffer) { //useMemo IT ???\r\n    var ab = new ArrayBuffer(buffer.length);\r\n    var view = new Uint8Array(ab);\r\n    for (var i = 0; i < buffer.length; ++i) view[i] = buffer[i];\r\n    return ab;\r\n}"]},"metadata":{},"sourceType":"module"}